<!DOCTYPE html>
<html lang="my">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ZAW GYI & PAI- 13DIGIT AI PREDICTOR</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <style>
    * {
      margin: 0; padding: 0; box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
    }
    html, body {
      min-height: 100%;
      font-family: 'Share Tech Mono', monospace;
      background: linear-gradient(135deg, #0a1929, #142850);
      color: #00ffcc;
    }
    .container {
      max-width: 96%;
      min-height: 100vh;
      margin: 0 auto;
      padding: 15px;
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 1;
    }
    .header {
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 2px solid rgba(0, 255, 204, 0.3);
      text-align: center;
      animation: fadeIn 1s ease;
    }
    h1 {
      color: #4fc3f7;
      font-size: 1.6rem;
      margin-bottom: 5px;
      letter-spacing: 3px;
    }
    .subtitle {
      color: #e0f7fa;
      font-size: 0.9rem;
      margin-bottom: 10px;
    }
    .content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }
    .stats-container {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      gap: 10px;
    }
    .stat-box {
      flex: 1;
      background: rgba(10, 25, 41, 0.8);
      border: 1px solid rgba(79, 195, 247, 0.3);
      border-radius: 12px;
      padding: 10px;
      text-align: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    .stat-title {
      font-size: 1.2rem;
      color: #b3e5fc;
      margin-bottom: 5px;
    }
    .stat-value {
      font-size: 1.5rem;
      font-weight: bold;
    }
    .win {
      color: #76ff03;
      text-shadow: 0 0 8px rgba(118, 255, 3, 0.6);
    }
    .lose {
      color: #ff5252;
    }
    .period-container {
      background: rgba(10, 25, 41, 0.8);
      border: 1px solid rgba(79, 195, 247, 0.3);
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    .period-title {
      font-size: 1rem;
      color: #b3e5fc;
    }
    .period-input {
      background: rgba(20, 40, 60, 0.8);
      border: 1px solid #4fc3f7;
      border-radius: 8px;
      color: #ffffff;
      padding: 8px;
      width: 120px;
      text-align: center;
      font-family: 'Share Tech Mono', monospace;
      font-size: 1.2rem;
    }
    .update-btn {
      background: linear-gradient(135deg, #00b0ff, #0091ea);
      border: none;
      border-radius: 8px;
      color: white;
      padding: 8px 15px;
      font-family: 'Share Tech Mono', monospace;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0, 176, 255, 0.3);
    }
    .pattern-display {
      background: rgba(10, 25, 41, 0.8);
      border: 1px solid rgba(79, 195, 247, 0.3);
      border-radius: 12px;
      padding: 15px 10px;
      margin: 10px 0;
      min-height: 90px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 5px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    .digit {
      width: 32px;
      height: 42px;
      border-radius: 10px;
      background: linear-gradient(135deg, #1a237e, #283593);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.2rem;
      color: #82b1ff;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    }
    .digit.B {
      background: linear-gradient(135deg, #d32f2f, #b71c1c);
      color: #ffcdd2;
      box-shadow: 0 4px 8px rgba(211, 47, 47, 0.4);
    }
    .digit.S {
      background: linear-gradient(135deg, #1976d2, #0d47a1);
      color: #bbdefb;
      box-shadow: 0 4px 8px rgba(25, 118, 210, 0.4);
    }
    .digit.placeholder {
      opacity: 0.3;
      background: rgba(30, 30, 70, 0.5);
    }
    .result-container {
      margin: 15px 0;
      padding: 15px;
      border-radius: 12px;
      border: 2px solid rgba(79, 195, 247, 0.5);
      background: rgba(10, 25, 41, 0.8);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }
    .result-header {
      color: #ff6b81;
      margin-bottom: 15px;
      font-size: 1rem;
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 2px;
    }
    .prediction {
      font-size: 3.5rem;
      color: #4fc3f7;
      margin: 15px 0;
      text-shadow: 0 0 15px rgba(79, 195, 247, 0.8);
      text-align: center;
      min-height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }
    .confidence {
      font-size: 1.2rem;
      color: #ffd54f;
      text-align: center;
      min-height: 3px;
      text-shadow: 0 0 8px rgba(255, 213, 79, 0.6);
    }
    .controls {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      margin-top: 10px;
    }
    .btn {
      padding: 14px 5px;
      font-size: 1.1rem;
      border-radius: 12px;
      cursor: pointer;
      color: white;
      font-weight: bold;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    .btn-big {
      background: linear-gradient(135deg, #ff5252, #d32f2f);
    }
    .btn-small {
      background: linear-gradient(135deg, #448aff, #2979ff);
    }
    .btn-win {
      background: linear-gradient(135deg, #69f0ae, #00e676);
    }
    .btn-lose {
      background: linear-gradient(135deg, #ff5252, #ff1744);
    }
    .btn-delete {
      grid-column: span 2;
      background: linear-gradient(135deg, #b388ff, #7c4dff);
      font-size: 1rem;
    }
    .btn-clear {
      background: linear-gradient(135deg, #ff6e40, #ff3d00);
      font-size: 1rem;
    }
    .status {
      margin-top: 15px;
      font-size: 0.9rem;
      color: #ffd54f;
      text-align: center;
      min-height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .spinner {
      border: 4px solid rgba(79, 195, 247, 0.3);
      border-top: 4px solid #4fc3f7;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
      display: none;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .footer {
      margin-top: 15px;
      font-size: 0.8rem;
      color: #b3e5fc;
      text-align: center;
      padding: 10px 0;
      border-top: 1px solid rgba(79, 195, 247, 0.3);
    }
    .no-match {
      color: #ff5252;
      font-size: 1.1rem;
      text-align: center;
      padding: 10px;
      display: none;
    }
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 20px;
      border-radius: 8px;
      color: white;
      z-index: 1000;
      opacity: 0;
      transform: translateX(100px);
      transition: all 0.3s ease;
      max-width: 300px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .notification.show {
      opacity: 1;
      transform: translateX(0);
    }
    .notification.success {
      background: linear-gradient(135deg, #69f0ae, #00c853);
      border-left: 5px solid #00e676;
    }
    .notification.error {
      background: linear-gradient(135deg, #ff5252, #d50000);
      border-left: 5px solid #ff1744;
    }
    .notification.info {
      background: linear-gradient(135deg, #448aff, #2962ff);
      border-left: 5px solid #2979ff;
    }
    .notification.warning {
      background: linear-gradient(135deg, #ffab40, #ff9100);
      border-left: 5px solid #ff6d00;
    }
    .additional-controls {
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
      margin-top: 10px;
    }
    
    /* Key Access Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      backdrop-filter: blur(4px);
    }
    .modal-overlay.show {
      opacity: 1;
      visibility: visible;
    }
    .modal {
      background: linear-gradient(135deg, #0a1929, #142850);
      border-radius: 12px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
      max-width: 450px;
      width: 90%;
      border: 2px solid rgba(79, 195, 247, 0.3);
      transform: scale(0.9);
      transition: all 0.3s ease;
    }
    .modal-overlay.show .modal {
      transform: scale(1);
    }
    .modal-header {
      padding: 15px 20px;
      border-bottom: 1px solid rgba(79, 195, 247, 0.3);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .modal-title {
      font-size: 1.2rem;
      color: #4fc3f7;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .modal-close {
      background: none;
      border: none;
      font-size: 1.2rem;
      color: #b3e5fc;
      cursor: pointer;
      padding: 5px;
      border-radius: 6px;
      transition: all 0.3s ease;
    }
    .modal-close:hover {
      background: rgba(79, 195, 247, 0.2);
    }
    .modal-body {
      padding: 20px;
    }
    .modal-footer {
      padding: 15px 20px;
      border-top: 1px solid rgba(79, 195, 247, 0.3);
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-label {
      display: block;
      margin-bottom: 8px;
      color: #b3e5fc;
      font-size: 0.9rem;
    }
    .form-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #4fc3f7;
      border-radius: 8px;
      background: rgba(20, 40, 60, 0.8);
      color: white;
      font-family: 'Share Tech Mono', monospace;
      font-size: 1rem;
    }
    .form-input:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.3);
    }
    .btn-key {
      background: linear-gradient(135deg, #00b0ff, #0091ea);
      border: none;
      border-radius: 8px;
      color: white;
      padding: 12px 20px;
      font-family: 'Share Tech Mono', monospace;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0, 176, 255, 0.3);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .btn-key:hover {
      background: linear-gradient(135deg, #0091ea, #0077c2);
    }
    .btn-contact {
      background: linear-gradient(135deg, #4361ee, #3a0ca3);
      border: none;
      border-radius: 8px;
      color: white;
      padding: 10px 15px;
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.9rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 15px;
      width: 100%;
      justify-content: center;
    }
    .btn-contact:hover {
      background: linear-gradient(135deg, #3a0ca3, #7209b7);
    }
    .access-message {
      text-align: center;
      margin-top: 15px;
      color: #b3e5fc;
      font-size: 0.9rem;
    }
    
    @media (min-width: 768px) {
      .container {
        max-width: 500px;
      }
      h1 {
        font-size: 2rem;
      }
      .digit {
        width: 38px;
        height: 48px;
        font-size: 1.4rem;
      }
      .btn {
        font-size: 1.2rem;
        padding: 16px 5px;
      }
    }
    @media (max-height: 700px) {
      .container {
        gap: 10px;
      }
      .header {
        margin-bottom: 5px;
        padding-bottom: 5px;
      }
      .stats-container, .period-container {
        margin-bottom: 8px;
      }
      .pattern-display {
        min-height: 70px;
        padding: 10px 5px;
        margin: 8px 0;
      }
      .result-container {
        margin: 10px 0;
        padding: 10px;
      }
      .prediction {
        font-size: 2.8rem;
        margin: 10px 0;
        min-height: 50px;
      }
      .btn {
        padding: 10px 5px;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div id="notification" class="notification">
    <i class="fas fa-info-circle"></i>
    <span class="notification-text"></span>
  </div>
  
  <!-- Key Access Modal -->
  <div class="modal-overlay" id="keyModal">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">
          <i class="fas fa-key"></i>
          License Key Access
        </div>
        <button class="modal-close" onclick="closeModal('keyModal')">
          <i class="fas fa-times"></i>+
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">Enter License Key</label>
          <input type="text" id="licenseKeyInput" class="form-input" placeholder="Enter your license key">
        </div>
        <button class="btn-key" onclick="validateLicenseKey()">
          <i class="fas fa-unlock"></i>
          Validate Key
        </button>
        <div class="access-message" id="accessMessage">
          Enter a valid license key to access the AI predictor
        </div>
        <button class="btn-contact" onclick="contactDeveloper()">
          <i class="fas fa-paper-plane"></i>
          Contact Developer: @leostrike223
        </button>
      </div>
    </div>
  </div>
  
  <div class="container" id="mainApp" style="display: none;">
    <div class="header">
      <h1><i class="head"></i> ZAW GYI/PAI-13DIGIT AI</h1>
      <div class="subtitle">AI Matching Predictor with Enhanced Win/Lose Logic</div>
    </div>
    
    <div class="content">
      <div class="stats-container">
        <div class="stat-box">
          <div class="stat-title">WIN STREAK</div>
          <div class="stat-value win" id="winCount">0</div>
        </div>
        <div class="stat-box">
          <div class="stat-title">LOSE STREAK</div>
          <div class="stat-value lose" id="loseCount">0</div>
        </div>
      </div>
      
      <div class="period-container">
        <div class="period-title"><i class="fas fa-calendar-alt"></i> PERIOD</div>
        <input type="number" min="1" class="period-input" id="periodInput" value="1">
        <button class="update-btn" id="btnUpdatePeriod">UPDATE</button>
      </div>
      
      <div class="pattern-display" id="patternDisplay">
        <!-- Digits addhere -->
      </div>
      
      <div class="no-match" id="noMatchMessage">
        <i class="fas fa-exclamation-triangle"></i> No matching pattern in AI
      </div>
      
      <div class="result-container">
        <div class="result-header">AI SERVER RESULT</div>
        <div class="prediction" id="prediction">?</div>
        <div class="confidence" id="confidence">Waiting for pattern input...</div>
        <div class="spinner" id="spinner"></div>
      </div>
      <div class="status" id="status">
        <i class="fas fa-info-circle"></i> Enter (B/S) for prediction
      </div>
    </div>
    
    <div class="controls">
      <button class="btn btn-big" id="btnBig"><i></i> BIG</button>
      <button class="btn btn-small" id="btnSmall"><i></i> SMALL</button>
      <button class="btn btn-win" id="btnWin"><i></i> WIN</button>
      <button class="btn btn-lose" id="btnLose"><i></i> LOSE</button>
      <button class="btn btn-delete" id="btnDelete"><i></i> DELETE LAST</button>
    </div>
    
    <div class="additional-controls">
      <button class="btn btn-clear" id="btnClear"><i></i> CLEAR ALL DATA</button>
    </div>
    
    <div class="footer">
      <i class="fas fa-copyright"></i> AI Prediction System 2025 | Win reduces lose count by 1
      <div style="margin-top: 5px;">
      </div>
    </div>
  </div>

  <script>
    // Firebase configuration for license keys
    const licenseFirebaseConfig = {
      apiKey: "AIzaSyBNDFi-i58PXRAu0w57armj_Dpn42X6i5g",
      authDomain: "admin-panel-17295.firebaseapp.com",
      databaseURL: "https://admin-panel-17295-default-rtdb.firebaseio.com",
      projectId: "admin-panel-17295",
      storageBucket: "admin-panel-17295.firebasestorage.app",
      messagingSenderId: "185281989467",
      appId: "1:185281989467:web:e47fb327d0c4223483287e",
      measurementId: "G-63JZ6YDWXQ"
    };
    
    // Firebase configuration for app data
    const firebaseConfig = {
      apiKey: "AIzaSyAaqQUWLbb1SV64xsJ0CG7_jKW1PzD0MpA",
      authDomain: "zawaung-17bf0.firebaseapp.com",
      databaseURL: "https://zawaung-17bf0-default-rtdb.firebaseio.com",
      projectId: "zawaung-17bf0",
      storageBucket: "zawaung-17bf0.appspot.com",
      messagingSenderId: "1029965895021",
      appId: "1:1029965895021:web:e461ae53aaabcc9e527664"
    };
    
    // Initialize Firebase for app data
    firebase.initializeApp(firebaseConfig, "appData");
    const db = firebase.database(firebase.app("appData"));
    
    // Initialize Firebase for license keys
    const licenseApp = firebase.initializeApp(licenseFirebaseConfig, "licenseData");
    const licenseDb = firebase.database(licenseApp);
    
    // App variables
    let inputDigits = [];
    const patternLength = 13;
    let patternMap = {};
    let isProcessing = false;
    let winCount = 0;
    let loseCount = 0;
    let periodNumber = 1;
    let consecutiveLosses = 0; 
    const patternDisplay = document.getElementById('patternDisplay');
    const predictionEl = document.getElementById('prediction');
    const confidenceEl = document.getElementById('confidence');
    const statusEl = document.getElementById('status');
    const spinner = document.getElementById('spinner');
    const noMatchEl = document.getElementById('noMatchMessage');
    const winCountEl = document.getElementById('winCount');
    const loseCountEl = document.getElementById('loseCount');
    const periodInputEl = document.getElementById('periodInput');
    const notificationEl = document.getElementById('notification');
    const mainApp = document.getElementById('mainApp');
    const keyModal = document.getElementById('keyModal');
    const accessMessage = document.getElementById('accessMessage');
    
    // Check if user has a valid license key
    function checkLicenseStatus() {
      const savedKey = localStorage.getItem('licenseKey');
      const expiryTime = localStorage.getItem('licenseExpiry');
      
      if (savedKey && expiryTime && Date.now() < parseInt(expiryTime)) {
        // Valid license exists
        mainApp.style.display = 'flex';
        initApp();
      } else {
        // No valid license, show key modal
        showKeyModal();
        
        // Clear expired key
        if (savedKey) {
          localStorage.removeItem('licenseKey');
          localStorage.removeItem('licenseExpiry');
        }
      }
    }
    
    // Show key modal
    function showKeyModal() {
      keyModal.classList.add('show');
      mainApp.style.display = 'none';
    }
    
    // Close modal
    function closeModal(modalId) {
      document.getElementById(modalId).classList.remove('show');
    }
    
    // Validate license key
    function validateLicenseKey() {
      const key = document.getElementById('licenseKeyInput').value.trim();
      
      if (!key) {
        accessMessage.textContent = "Please enter a license key";
        accessMessage.style.color = "#ff5252";
        return;
      }
      
      accessMessage.textContent = "Validating key...";
      accessMessage.style.color = "#ffd54f";
      
      // Check key in Firebase
      licenseDb.ref('users/' + key).once('value').then(snapshot => {
        if (snapshot.exists()) {
          const keyData = snapshot.val();
          const now = Date.now();
          
          if (keyData.expiresAt > now) {
            // Key is valid
            if (keyData.userLimit && keyData.chatId) {
              // Key is already in use
              accessMessage.textContent = "This key is already assigned to another user";
              accessMessage.style.color = "#ff5252";
            } else {
              // Save key to localStorage
              localStorage.setItem('licenseKey', key);
              localStorage.setItem('licenseExpiry', keyData.expiresAt);
              
              // If user limit is enabled, mark this key as used
              if (keyData.userLimit) {
                licenseDb.ref('users/' + key).update({
                  chatId: 'user_' + Math.random().toString(36).substr(2, 9),
                  activationDate: now
                });
              }
              
              accessMessage.textContent = "License key accepted! Access granted.";
              accessMessage.style.color = "#76ff03";
              
              setTimeout(() => {
                closeModal('keyModal');
                mainApp.style.display = 'flex';
                initApp();
              }, 1500);
            }
          } else {
            // Key has expired
            accessMessage.textContent = "This license key has expired";
            accessMessage.style.color = "#ff5252";
          }
        } else {
          // Key doesn't exist
          accessMessage.textContent = "Invalid license key";
          accessMessage.style.color = "#ff5252";
        }
      }).catch(error => {
        accessMessage.textContent = "Error validating key: " + error.message;
        accessMessage.style.color = "#ff5252";
      });
    }
    
    // Contact developer
    function contactDeveloper() {
      window.open('https://t.me/leostrike223', '_blank');
    }
    
    // Show notification
    function showNotification(message, type = 'info') {
      const icon = type === 'success' ? 'fa-check-circle' : 
                  type === 'error' ? 'fa-exclamation-circle' :
                  type === 'warning' ? 'fa-exclamation-triangle' : 'fa-info-circle';
      
      notificationEl.innerHTML = `<i class="fas ${icon}"></i> <span class="notification-text">${message}</span>`;
      notificationEl.className = `notification ${type}`;
      notificationEl.classList.add('show');
      
      setTimeout(() => {
        notificationEl.classList.remove('show');
      }, 3000);
    }
    
    // Load pattern map
    function loadPatternMap() {
      spinner.style.display = 'block';
      statusEl.textContent = "Loading pattern data from Firebase...";
      
      //pattern map
      patternMap = {
        "BBBSB": "S",
        "SBSSB": "B",
        "BSSBS": "B",
        "BSBBS": "B",
        "BBSBS": "S",
        "BBBSB": "B",
        "BBBBB": "B",
        "BBBBS": "S",
        "SBBSS": "S",
        "BSSSS": "B",
        "SSSSB": "S",
        "SSSBS": "B",
        "SBSBS": "S",
        "BSBSB": "S",
        "SBSBB": "S",
        "SSBSB": "S",
        "BSBSS": "B",
        "SBSBB": "S",
        "BBSSS": "S",
        "BBSSB": "B",
        "BSSBB": "S",
        "SSBBB": "B",
        "SBBBS": "B",
        "BSBSS": "B",
        "BBBSS": "B",
        "BSSSB": "B",
        "SBBSB": "B",
        "BBSBB": "B",
        "BSBBB": "S",
        "SBBBB": "S",
        "SSBSS": "S",
        "SSSBS": "B",
        "SBSSS": "B"
      };
      
      console.log("PatternMap Loaded:", Object.keys(patternMap).length + " patterns");
      spinner.style.display = 'none';
      statusEl.textContent = `Enter pattern (B/S)`;
      noMatchEl.style.display = 'none';
      showNotification("Pattern data loaded successfully", "success");
    }
    
    // Update pattern display
    function updatePatternDisplay() {
      patternDisplay.innerHTML = '';
      
      // Add entered digits
      inputDigits.forEach(d => {
        const digitEl = document.createElement('div');
        digitEl.className = `digit ${d}`;
        digitEl.textContent = d;
        patternDisplay.appendChild(digitEl);
      });
      
      // Add placeholders for remaining digits
      const remaining = patternLength - inputDigits.length;
      for (let i = 0; i < remaining; i++) {
        const placeholder = document.createElement('div');
        placeholder.className = 'digit placeholder';
        placeholder.textContent = '_';
        patternDisplay.appendChild(placeholder);
      }
    }
    
    // Determine if prediction should be reversed
    function shouldReversePrediction() {
      if (consecutiveLosses <= 0) return false;
      
      const cycle = Math.floor((consecutiveLosses - 1) / 2) + 1;
      const positionInCycle = (consecutiveLosses - 1) % 2;
      
      if (cycle % 2 === 1) {
        return positionInCycle === 0; 
      } else {
        return positionInCycle === 1; 
      }
    }
    
    // Find best pattern match
    function findBestMatch() {
      if (inputDigits.length < patternLength) return null;
      
      // Get last 5 digits
      const lastFive = inputDigits.slice(-5).join('');
      
      // Check if pattern exists
      if (patternMap[lastFive]) {
        let predictionValue = patternMap[lastFive];
        const shouldReverse = shouldReversePrediction();
        
        // Apply reverse logic if needed
        if (shouldReverse) {
          predictionValue = predictionValue === 'B' ? 'S' : 'B';
        }
        
        const displayValue = predictionValue === 'B' ? 'BIG' : 'SMALL';
        const confidence = 100;
        
        return { 
          pattern: lastFive, 
          value: predictionValue, 
          displayValue: displayValue,
          confidence: confidence,
          reversed: shouldReverse
        };
      }
      
      return null;
    }
    
    // Show prediction result
    function showResult() {
      if (isProcessing) return;
      
      isProcessing = true;
      spinner.style.display = 'block';
      predictionEl.textContent = '?';
      confidenceEl.textContent = 'Analyzing pattern...';
      statusEl.textContent = "Connecting to AI server...";
      noMatchEl.style.display = 'none';
      
      setTimeout(() => {
        const match = findBestMatch();
        
        if (match) {
          predictionEl.textContent = match.displayValue;
          let confidenceText = `Confidence: ${match.confidence}%`;
          
          if (match.reversed) {
            confidenceText += " (Reversed Prediction)";
          }
          
          confidenceEl.textContent = confidenceText;
          confidenceEl.style.color = match.confidence > 70 ? '#76ff03' : 
                                  match.confidence > 50 ? '#ffd54f' : '#ff5252';
          
          statusEl.textContent = "Prediction complete";
          noMatchEl.style.display = 'none';
          showNotification(`Prediction: ${match.displayValue}${match.reversed ? ' (Reversed)' : ''}`, "success");
        } else {
          predictionEl.textContent = '?';
          confidenceEl.textContent = '';
          statusEl.textContent = "No matching pattern found";
          noMatchEl.style.display = 'block';
          showNotification("No matching pattern found", "warning");
        }
        
        spinner.style.display = 'none';
        isProcessing = false;
      }, 1500);
    }
    
    // Handle digit input
    function handleInput(val) {
      if (inputDigits.length >= patternLength) {
        inputDigits.shift();
      }
      inputDigits.push(val);
      updatePatternDisplay();
      showNotification(`Added ${val} to pattern`, "info");
  
      if (inputDigits.length === patternLength) {
        showResult();
      } else {
        predictionEl.textContent = '?';
        confidenceEl.textContent = '';
        statusEl.textContent = `Enter ${patternLength - inputDigits.length} more digits`;
        noMatchEl.style.display = 'none';
      }
    }
    
    // Delete last input
    function deleteLastInput() {
      if (inputDigits.length > 0) {
        const removed = inputDigits.pop();
        updatePatternDisplay();
        showNotification(`Removed ${removed} from pattern`, "info");
        
        predictionEl.textContent = '?';
        confidenceEl.textContent = '';
        noMatchEl.style.display = 'none';
        
        // Update status message
        if (inputDigits.length === 0) {
          statusEl.textContent = "Enter (B/S) for prediction";
        } else {
          statusEl.textContent = `Enter ${patternLength - inputDigits.length} more digits`;
        }
      } else {
        showNotification("No digits to delete", "warning");
      }
    }
    
    // Clear all data
    function clearAllData() {
      inputDigits = [];
      updatePatternDisplay();
      predictionEl.textContent = '?';
      confidenceEl.textContent = 'Waiting for pattern input...';
      statusEl.textContent = "Enter (B/S) for prediction";
      noMatchEl.style.display = 'none';
      showNotification("All data cleared", "success");
    }
    
    // Handle win
    function handleWin() {
      winCount++;
      winCountEl.textContent = winCount;
      showNotification("Win recorded!", "success");
      
      // Reduce lose count by 1
      if (loseCount > 0) {
        loseCount--;
        loseCountEl.textContent = loseCount;
      }
      
      // Reset consecutive losses
      consecutiveLosses = 0;
    }
    
    // Handle lose
    function handleLose() {
      loseCount++;
      loseCountEl.textContent = loseCount;
      consecutiveLosses++;
      showNotification("Loss recorded", "warning");
    }
    
    // Update period
    function updatePeriod() {
      const newPeriod = parseInt(periodInputEl.value);
      if (!isNaN(newPeriod) && newPeriod > 0) {
        periodNumber = newPeriod;
        showNotification(`Period updated to ${periodNumber}`, "info");
      } else {
        periodInputEl.value = periodNumber;
        showNotification("Invalid period number", "error");
      }
    }
    
    // Initialize the app
    function initApp() {
      // Initialize pattern display
      updatePatternDisplay();
      
      // Set up event listeners
      document.getElementById('btnBig').addEventListener('click', () => handleInput('B'));
      document.getElementById('btnSmall').addEventListener('click', () => handleInput('S'));
      document.getElementById('btnWin').addEventListener('click', handleWin);
      document.getElementById('btnLose').addEventListener('click', handleLose);
      document.getElementById('btnDelete').addEventListener('click', deleteLastInput);
      document.getElementById('btnClear').addEventListener('click', clearAllData);
      document.getElementById('btnUpdatePeriod').addEventListener('click', updatePeriod);
      
      // Load pattern map
      loadPatternMap();
      
      // Show welcome message
      showNotification("Welcome to ZAW GYI-13DIGIT AI Predictor", "info");
    }
    
    // Check license status on page load
    document.addEventListener('DOMContentLoaded', checkLicenseStatus);
  </script>
</body>
</html>
